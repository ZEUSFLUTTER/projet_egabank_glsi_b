<div class="p-6">
    <div class="mb-6 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-bold mb-2">Gestion des Clients</h1>
            <p class="text-gray-500">Consultez et gérez les clients de votre banque et leurs associations.</p>
        </div>
        <a routerLink="/admin/clients/new" class="btn btn-primary">
            <i class="ri-user-add-line" style="margin-right: 0.5rem;"></i> Ajouter Client
        </a>
    </div>

    <!-- Error State -->
    <div *ngIf="errorMessage && !isLoading" class="alert alert-danger mb-4">
        <i class="ri-error-warning-line"></i> {{ errorMessage }}
        <button (click)="loadClients()" class="btn btn-sm btn-secondary ml-2">
            <i class="ri-refresh-line"></i> Réessayer
        </button>
    </div>

    <!-- Loading State (Skeleton Table) -->
    <div *ngIf="isLoading" class="card overflow-hidden">
        <table class="clients-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Téléphone</th>
                    <th>Comptes</th>
                    <th>Statut</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let i of [1,2,3,4,5,6]">
                    <td><div class="skeleton skeleton-text" style="width: 40px;"></div></td>
                    <td><div class="skeleton skeleton-text" style="width: 120px;"></div></td>
                    <td><div class="skeleton skeleton-text" style="width: 150px;"></div></td>
                    <td><div class="skeleton skeleton-text" style="width: 100px;"></div></td>
                    <td><div class="skeleton skeleton-text" style="width: 30px;"></div></td>
                    <td><div class="skeleton skeleton-text" style="width: 60px;"></div></td>
                    <td><div class="skeleton skeleton-text" style="width: 150px;"></div></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Clients Table -->
    <div *ngIf="!isLoading && clients.length > 0" class="card overflow-hidden">
        <table class="clients-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Téléphone</th>
                    <th>Comptes</th>
                    <th>Statut</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let client of clients">
                    <td class="text-gray-500 text-sm">{{client.id}}</td>
                    <td>
                        <div class="font-semibold">{{client.prenom}} {{client.nom}}</div>
                    </td>
                    <td>
                        <div class="text-sm text-gray-600 flex items-center gap-1">
                            <i class="ri-mail-line text-gray-400"></i> {{client.courriel || '-'}}
                        </div>
                    </td>
                    <td>
                        <div class="text-sm text-gray-600 flex items-center gap-1">
                            <i class="ri-phone-line text-gray-400"></i> {{client.telephone || '-'}}
                        </div>
                    </td>
                    <td class="text-center">
                        <span class="accounts-badge">{{client.nombreComptes || 0}}</span>
                    </td>
                    <td>
                        <div *ngIf="client.enabled !== undefined"
                             [class]="client.enabled ? 'status-badge active' : 'status-badge pending'">
                            <span *ngIf="client.enabled" class="flex items-center gap-1">
                                <i class="ri-checkbox-circle-fill"></i> Actif
                            </span>
                            <span *ngIf="!client.enabled" class="flex items-center gap-1">
                                <i class="ri-time-line"></i> En attente
                            </span>
                        </div>
                        <span *ngIf="client.enabled === undefined" class="text-gray-400 text-sm">-</span>
                    </td>
                    <td>
                        <div class="flex gap-2 flex-wrap">
                            <button (click)="viewDetails(client.id)" class="btn-action btn-action-secondary" title="Modifier">
                                <i class="ri-edit-line"></i>
                            </button>
                            <button (click)="viewAccounts(client.id)" class="btn-action btn-action-primary" title="Voir Comptes">
                                <i class="ri-bank-card-line"></i>
                            </button>
                            <button *ngIf="client.userId && !client.enabled"
                                    (click)="activateClient(client)"
                                    class="btn-action btn-action-success"
                                    title="Activer le compte">
                                <i class="ri-check-line"></i>
                            </button>
                            <button *ngIf="client.userId && client.enabled"
                                    (click)="deactivateClient(client)"
                                    class="btn-action btn-action-warning"
                                    title="Désactiver le compte">
                                <i class="ri-close-line"></i>
                            </button>
                            <button (click)="deleteClient(client.id)" class="btn-action btn-action-danger" title="Supprimer client">
                                <i class="ri-delete-bin-line"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && clients.length === 0 && !errorMessage" class="card p-12 text-center">
        <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;">
            <i class="ri-user-add-line"></i>
        </div>
        <h3 class="font-bold text-lg mb-2 text-gray-700">Aucun Client</h3>
        <p class="text-gray-500 mb-4">Commencez par ajouter votre premier client.</p>
        <a routerLink="/admin/clients/new" class="btn btn-primary">
            <i class="ri-add-line" style="margin-right: 0.5rem;"></i> Ajouter Premier Client
        </a>
    </div>
</div>

<style>
/* Table Styles */
.clients-table {
    width: 100%;
    border-collapse: collapse;
}

.clients-table thead {
    background-color: #f8fafc;
    border-bottom: 2px solid #e2e8f0;
}

.clients-table th {
    padding: 0.875rem 1rem;
    text-align: left;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    color: #64748b;
    letter-spacing: 0.05em;
}

.clients-table td {
    padding: 0.875rem 1rem;
    border-bottom: 1px solid #f1f5f9;
    vertical-align: middle;
}

.clients-table tbody tr:hover {
    background-color: #f8fafc;
}

.clients-table tbody tr:last-child td {
    border-bottom: none;
}

/* Accounts Badge */
.accounts-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 1.5rem;
    padding: 0.25rem 0.5rem;
    background-color: #e0f2fe;
    color: #0369a1;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 600;
}

/* Status Badges */
.status-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 500;
}

.status-badge.active {
    background-color: #d1fae5;
    color: #065f46;
    border: 1px solid #a7f3d0;
}

.status-badge.pending {
    background-color: #fef3c7;
    color: #92400e;
    border: 1px solid #fde68a;
}

.status-badge i {
    font-size: 0.875rem;
}

/* Action Buttons */
.btn-action {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 38px;
    height: 38px;
    border-radius: 8px;
    border: 1px solid transparent;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 1.125rem;
}

.btn-action-primary {
    background-color: #dbeafe;
    color: #1d4ed8;
    border-color: #bfdbfe;
}

.btn-action-primary:hover {
    background-color: #3b82f6;
    border-color: #3b82f6;
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
}

.btn-action-secondary {
    background-color: #f1f5f9;
    color: #475569;
    border-color: #e2e8f0;
}

.btn-action-secondary:hover {
    background-color: #64748b;
    border-color: #64748b;
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(100, 116, 139, 0.3);
}

.btn-action-success {
    background-color: #dcfce7;
    color: #15803d;
    border-color: #bbf7d0;
}

.btn-action-success:hover {
    background-color: #22c55e;
    border-color: #22c55e;
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(34, 197, 94, 0.3);
}

.btn-action-warning {
    background-color: #fef3c7;
    color: #b45309;
    border-color: #fde68a;
}

.btn-action-warning:hover {
    background-color: #f59e0b;
    border-color: #f59e0b;
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.3);
}

.btn-action-danger {
    background-color: #fee2e2;
    color: #dc2626;
    border-color: #fecaca;
}

.btn-action-danger:hover {
    background-color: #ef4444;
    border-color: #ef4444;
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3);
}

.btn-action-info {
    background-color: #e0f2fe;
    color: #0284c7;
    border-color: #bae6fd;
}

.btn-action-info:hover {
    background-color: #0ea5e9;
    border-color: #0ea5e9;
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(14, 165, 233, 0.3);
}

/* Responsive */
@media (max-width: 1024px) {
    .clients-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
    }
}
</style>
