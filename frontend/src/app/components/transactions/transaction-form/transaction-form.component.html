<div class="card" style="max-width: 600px; margin: 2rem auto;">
  <div class="card-header">Nouvelle transaction</div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="transactionType">Type de transaction *</label>
      <select id="transactionType" formControlName="transactionType" (change)="onTypeChange()" class="form-control">
        <option value="depot">Dépôt</option>
        <option value="retrait">Retrait</option>
        <option value="virement">Virement</option>
      </select>
    </div>

    <div class="form-group">
      <label for="compteId">{{ transactionForm.get('transactionType')?.value === 'virement' ? 'Compte source *' : 'Compte *' }}</label>
      <select id="compteId" formControlName="compteId" class="form-control">
        <option value="">Sélectionner un compte</option>
        <option *ngFor="let compte of comptes" [value]="compte.id">
          {{ compte.numeroCompte }} - {{ compte.typeCompte }} ({{ compte.solde | number:'1.2-2' }} FCFA)
        </option>
      </select>
    </div>

    <div class="form-group" *ngIf="transactionForm.contains('compteDestinationId')">
      <label for="compteDestinationId">Compte destination *</label>
      <select id="compteDestinationId" formControlName="compteDestinationId" class="form-control">
        <option value="">Sélectionner un compte</option>
        <option *ngFor="let compte of comptes" [value]="compte.id">
          {{ compte.numeroCompte }} - {{ compte.typeCompte }} ({{ compte.solde | number:'1.2-2' }} FCFA)
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="montant">Montant *</label>
      <input type="number" id="montant" formControlName="montant" step="0.01" min="0.01" class="form-control"/>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea id="description" formControlName="description" class="form-control" rows="3"></textarea>
    </div>

    <div class="d-flex gap-2">
      <button type="submit" class="btn btn-primary" [disabled]="transactionForm.invalid">Valider</button>
      <a routerLink="/transactions" class="btn btn-secondary">Annuler</a>
    </div>
  </form>
</div>
